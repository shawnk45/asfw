!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"function"==typeof require?e(require("jquery")):e(jQuery)}(function(e){"use strict";var t={escapeRegExChars:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}},s=27,n=9,o=13,i=38,a=39,l=40;function r(t,s){var n=e.noop,o=this,i={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,onMouseOver:null,onMouseLeave:null,width:"auto",containerDetailsWidth:"auto",showDetailsPanel:!1,showImage:!1,showPrice:!1,showSKU:!1,showDescription:!1,showSaleBadge:!1,showFeaturedBadge:!1,saleBadgeText:"sale",featuredBadgeText:"featured",minChars:3,maxHeight:600,deferRequestBy:0,params:{},formatResult:r.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,is_rtl:!1,onSearchStart:n,onSearchComplete:n,onSearchError:n,preserveInput:!1,searchFormClass:"dgwt-wcas-search-wrapp",containerClass:"dgwt-wcas-suggestions-wrapp",containerDetailsClass:"dgwt-wcas-details-wrapp",searchInputClass:"dgwt-wcas-search-input",preloaderClass:"dgwt-wcas-preloader",closeTrigger:"dgwt-wcas-close",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,s){return-1!==e.value.toLowerCase().indexOf(s)},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1,positionFixed:!1};o.element=t,o.el=e(t),o.suggestions=[],o.badQueries=[],o.selectedIndex=-1,o.currentValue=o.element.value,o.intervalId=0,o.cachedResponse={},o.cachedDetails={},o.detailsRequestsSent=[],o.onChangeInterval=null,o.onChange=null,o.isLocal=!1,o.suggestionsContainer=null,o.detailsContainer=null,o.noSuggestionsContainer=null,o.options=e.extend({},i,s),o.classes={selected:"dgwt-wcas-suggestion-selected",suggestion:"dgwt-wcas-suggestion"},o.hint=null,o.hintValue="",o.selection=null,o.initialize(),o.setOptions(s)}r.utils=t,e.Autocomplete=r,r.formatResult=function(e,s){if(!s)return e;var n="("+t.escapeRegExChars(s)+")";return e.replace(new RegExp(n,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},r.prototype={killerFn:null,initialize:function(){var t,s,n=this,o="."+n.classes.suggestion,i=(n.classes.selected,n.options),a="."+i.closeTrigger;n.element.setAttribute("autocomplete","off"),n.killerFn=function(t){0===e(t.target).closest("."+n.options.containerClass).length&&0===e(t.target).closest("."+n.options.containerDetailsClass).length&&(n.killSuggestions(),n.disableKillerFn())};var l=n.el.closest("."+i.searchFormClass).data("wcas-context");n.noSuggestionsContainer=e('<div class="dgwt-wcas-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),n.suggestionsContainer=r.utils.createNode(i.containerClass),(t=e(n.suggestionsContainer)).attr("data-wcas-context",l),t.appendTo("body"),!0===i.showImage&&t.addClass("dgwt-wcas-has-img"),!0===i.showPrice&&t.addClass("dgwt-wcas-has-price"),!0===i.showDescription&&t.addClass("dgwt-wcas-has-desc"),!0===i.showSKU&&t.addClass("dgwt-wcas-has-sku"),"auto"!==i.width&&t.width(i.width),!0===i.showDetailsPanel&&(n.detailsContainer=r.utils.createNode(i.containerDetailsClass),(s=e(n.detailsContainer)).attr("data-wcas-context",l),s.appendTo("body")),t.on("mouseover.autocomplete",o,function(){n.onMouseOver(e(this).data("index")),n.activate(e(this).data("index"))}),t.on("mouseout.autocomplete",function(){}),e(document).on("click.autocomplete",a,function(t){n.killerFn(t),n.clear(!1),e(this).removeClass(i.closeTrigger),e(this).closest("."+i.searchFormClass).find("."+i.searchInputClass).val("").focus()}),t.on("click.autocomplete",o,function(){return n.select(e(this).data("index")),!1}),e(document).on("change",'[name="js-dgwt-wcas-quantity"]',function(t){e(this).closest(".js-dgwt-wcas-pd-addtc").find("[data-quantity]").attr("data-quantity",e(this).val())}),n.fixPositionCapture=function(){n.adjustContainerWidth(),n.visible&&n.fixPosition()},e(window).on("resize.autocomplete",n.fixPositionCapture),n.el.on("keydown.autocomplete",function(e){n.onKeyPress(e)}),n.el.on("keyup.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("blur.autocomplete",function(){n.onBlur()}),n.el.on("focus.autocomplete",function(){n.onFocus()}),n.el.on("change.autocomplete",function(e){n.onKeyUp(e)}),n.el.on("input.autocomplete",function(e){n.onKeyUp(e)})},onFocus:function(){var e=this;e.fixPositionCapture(),e.el.val().length>=e.options.minChars&&e.onValueChange()},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions:function(t){var s=this,n=s.options;e.extend(n,t),s.isLocal=e.isArray(n.lookup),s.isLocal&&(n.lookup=s.verifySuggestionsFormat(n.lookup)),n.orientation=s.validateOrientation(n.orientation,"bottom"),e(s.suggestionsContainer).css({"max-height":s.canShowDetailsBox()?"none":n.maxHeight+"px",width:n.width+"px","z-index":n.zIndex}),!0===n.showDetailsPanel&&(e(s.detailsContainer).css({"z-index":n.zIndex-1}),e(s.suggestionsContainer).parent().addClass("dgwt-wcas-is-details")),s.options.onSearchComplete=function(){s.preloader("hide","form","dgwt-wcas-inner-preloader"),s.preloader("show","form",n.closeTrigger)},s.autoBlurOnMobile()},autoBlurOnMobile:function(){var e=this;"ontouchend"in document&&document.addEventListener("scroll",function(t){e.el.blur()},!0)},clearCache:function(){this.cachedResponse={},this.cachedDetails={},this.badQueries=[]},clear:function(e){e&&this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var e=this;e.disabled=!0,clearInterval(e.onChangeInterval),e.abortAjax()},enable:function(){this.disabled=!1},fixPosition:function(){var t=this,s=e(t.suggestionsContainer),n=t.getFormOffset();s.css(n),t.canShowDetailsBox()&&t.fixPositionDetailsBox()},fixPositionDetailsBox:function(){var t=this,s=t.el.closest("[data-wcas-context]"),n=e("."+t.options.containerDetailsClass+'[data-wcas-context="'+t.getContext()+'"]'),o=e("."+t.options.containerClass+'[data-wcas-context="'+t.getContext()+'"]'),i=t.getFormOffset(),a=i.left;if(0==n.length)return!1;var l=!0===t.options.is_rtl?1:2,r=Math.round(i.left);if(i.left=r+Math.round(o.width()+l),n.css(i),s.width()>=550)return e("body").removeClass("dgwt-wcas-details-outside"),e("body").removeClass("dgwt-wcas-details-right"),e("body").removeClass("dgwt-wcas-details-left"),void(!0===t.options.is_rtl&&(o.css("left",r+Math.round(n.width()+l)+"px"),n.css("left",a+"px")));var c=e(window).width(),d=n.width(),u=n.offset();e("body").addClass("dgwt-wcas-details-outside"),!0===t.options.is_rtl&&(i.left=i.left+1);var g=!1,h=!1;c<u.left+d&&(g=!0,e("body").removeClass("dgwt-wcas-details-right"),e("body").addClass("dgwt-wcas-details-left"),n.css("left",Math.round(parseFloat(o.css("left").replace("px","")))-n.outerWidth()+"px")),(u=n.offset()).left<1&&(h=!0,e("body").removeClass("dgwt-wcas-details-left"),e("body").addClass("dgwt-wcas-details-right")),h&&g?(e("body").removeClass("dgwt-wcas-details-left"),e("body").removeClass("dgwt-wcas-details-right"),e("body").addClass("dgwt-wcas-details-notfit")):e("body").removeClass("dgwt-wcas-details-notfit")},fixHeight:function(){var t=this.options;if(1!=t.showDetailsPanel)return!1;e("."+t.containerClass).css("height","auto"),e("."+t.containerDetailsClass).css("height","auto");var s=e("."+t.containerClass),n=e("."+t.containerDetailsClass),o=s.outerHeight(),i=n.outerHeight();return s.find(".dgwt-wcas-suggestion:last-child").removeClass("dgwt-wcas-suggestion-no-border-bottom"),!(o<=340&&i<=340)&&(s.find(".dgwt-wcas-suggestion:last-child").addClass("dgwt-wcas-suggestion-no-border-bottom"),i<o&&n.css("height",o+"px"),o<i&&s.css("height",i+"px"),!1)},getFormOffset:function(){var t=this,s=t.el.closest("."+t.options.searchFormClass),n=t.options.orientation,o=s.outerHeight(),i=t.el.outerHeight(),a=t.el.offset(),l={top:a.top,left:a.left};if("auto"===n){var r=e(window).height(),c=e(window).scrollTop(),d=-c+a.top-o,u=c+r-(a.top+i+o);n=Math.max(d,u)===d?"top":"bottom"}if("top"===n)if(!0===t.options.positionFixed){var g=t.el[0].getBoundingClientRect();l.top=g.top-e(t.suggestionsContainer).outerHeight()}else l.top+=-e(t.suggestionsContainer).outerHeight();else l.top+=i;return l},getContext:function(){var e=this.el.closest("[data-wcas-context]"),t="";return e.length>0&&(t=e.data("wcas-context")),t},getFormWrapper:function(){return this.el.closest("[data-wcas-context]")},enableKillerFn:function(){e(document).on("click.autocomplete",this.killerFn)},disableKillerFn:function(){e(document).off("click.autocomplete",this.killerFn)},killSuggestions:function(){var t=this;e(t.suggestionsContainer).parent();t.stopKillSuggestions(),t.intervalId=window.setInterval(function(){t.visible&&(t.options.preserveInput||t.el.val(t.currentValue),t.hide()),t.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e,t=this.el.val().length,s=this.element.selectionStart;return"number"==typeof s?s===t:!document.selection||((e=document.selection.createRange()).moveStart("character",-t),t===e.text.length)},onKeyPress:function(e){var t=this;if(t.disabled||t.visible||e.which!==l||!t.currentValue){if(!t.disabled&&t.visible){switch(e.which){case s:t.el.val(t.currentValue),t.hide();break;case a:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case n:if(t.hint&&t.options.onHint)return void t.selectHint();if(-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),!1===t.options.tabDisabled)return;break;case o:if(-1===t.selectedIndex)return void t.hide();t.select(t.selectedIndex);break;case i:t.moveUp();break;case l:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else t.suggest()},onKeyUp:function(e){var t=this;if(!t.disabled){switch(e.which){case i:case l:return}clearInterval(t.onChangeInterval),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy):t.onValueChange())}},onValueChange:function(){var t=this,s=t.options,n=t.el.val(),o=t.getQuery(n);t.selection&&t.currentValue!==o&&(t.selection=null,(s.onInvalidateSelection||e.noop).call(t.element)),clearInterval(t.onChangeInterval),t.currentValue=n,t.selectedIndex=-1,s.triggerSelectOnValidInput&&t.isExactMatch(o)?t.select(0):o.length<s.minChars?(e("."+t.options.closeTrigger).removeClass(t.options.closeTrigger),t.hide()):t.getSuggestions(o)},isExactMatch:function(e){var t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},canShowDetailsBox:function(){return 1==this.options.showDetailsPanel&&e(window).width()>=992&&!("ontouchend"in document)},getQuery:function(t){var s,n=this.options.delimiter;return n?(s=t.split(n),e.trim(s[s.length-1])):t},getSuggestionsLocal:function(t){var s,n=this.options,o=t.toLowerCase(),i=n.lookupFilter,a=parseInt(n.lookupLimit,10);return s={suggestions:e.grep(n.lookup,function(e){return i(e,t,o)})},a&&s.suggestions.length>a&&(s.suggestions=s.suggestions.slice(0,a)),s},getSuggestions:function(t){var s,n,o,i,a=this,l=a.options,r=l.serviceUrl;l.params[l.paramName]=t,n=l.ignoreParams?null:l.params,a.preloader("show","form","dgwt-wcas-inner-preloader"),!1!==l.onSearchStart.call(a.element,l.params)&&(e.isFunction(l.lookup)?l.lookup(t,function(e){a.suggestions=e.suggestions,a.suggest(),a.getDetails(e.suggestions[0]),l.onSearchComplete.call(a.element,t,e.suggestions)}):(a.isLocal?s=a.getSuggestionsLocal(t):(e.isFunction(r)&&(r=r.call(a.element,t)),o=r+"?"+e.param(n||{}),s=a.cachedResponse[o]),s&&e.isArray(s.suggestions)?(a.suggestions=s.suggestions,a.suggest(),a.getDetails(s.suggestions[0]),l.onSearchComplete.call(a.element,t,s.suggestions)):a.isBadQuery(t)?l.onSearchComplete.call(a.element,t,[]):(a.abortAjax(),i={url:r,data:n,type:l.type,dataType:l.dataType},e.extend(i,l.ajaxSettings),a.currentRequest=e.ajax(i).done(function(e){var s;a.currentRequest=null,void 0!==(s=l.transformResult(e,t)).suggestions&&(a.processResponse(s,t,o),a.getDetails(s.suggestions[0])),a.fixPositionCapture(),l.onSearchComplete.call(a.element,t,s.suggestions)}).fail(function(e,s,n){l.onSearchError.call(a.element,t,e,s,n)}))))},getDetails:function(t){var s=this,n=s.options;if(!s.canShowDetailsBox())return!1;if(null!=t){var o,i,a=e("."+n.containerDetailsClass);s.fixHeight();var l={action:dgwt_wcas.action_result_details,post_id:null!=t.post_id?t.post_id:0,term_id:null!=t.term_id?t.term_id:0,taxonomy:null!=t.taxonomy?t.taxonomy:"",value:null!=t.value?t.value:""};if(o=l.action+l.post_id+l.term_id+l.taxonomy,null!=(i=s.cachedDetails[o]))a.html(i.details),s.fixHeight(),s.fixPositionCapture();else{if(a.html(""),s.preloader("show","details","",!0),-1!=e.inArray(o,s.detailsRequestsSent))return;s.detailsRequestsSent.push(o),e.ajax({data:l,type:"post",url:dgwt_wcas.ajax_details_endpoint,success:function(e){var t="string"==typeof e?jQuery.parseJSON(e):e;s.cachedDetails[o]=t,s.preloader("hide","details","",!0),null!=t.details?a.html(t.details):a.html(""),s.fixPositionCapture(),s.fixHeight()},error:function(e,t){s.preloader("hide","details","",!0),a.html(e),s.fixPositionCapture(),s.fixHeight()}})}}},isBadQuery:function(e){if(!this.options.preventBadQueries)return!1;for(var t=this.badQueries,s=t.length;s--;)if(0===e.indexOf(t[s]))return!0;return!1},hide:function(){var t=this,s=e(t.suggestionsContainer),n=(e(t.detailsContainer),e(t.suggestionsContainer).parent());e.isFunction(t.options.onHide)&&t.visible&&t.options.onHide.call(t.element,s),t.visible=!1,t.selectedIndex=-1,clearInterval(t.onChangeInterval),e(t.suggestionsContainer).hide(),e(t.detailsContainer).hide(),n.removeClass("dgwt-wcas-open"),t.signalHint(null)},suggest:function(){if(this.suggestions.length){var t,s=this,n=s.options,o=n.groupBy,i=n.formatResult,a=s.getQuery(s.currentValue),l=s.classes.suggestion,r=s.classes.selected,c=e(s.suggestionsContainer),d=e(s.detailsContainer),u=e(s.noSuggestionsContainer),g=n.beforeRender,h="";n.triggerSelectOnValidInput&&s.isExactMatch(a)?s.select(0):(e.each(s.suggestions,function(e,s){var r,c="",d="",u=!1;if(o&&(h+=(r=s.data[o],t===r?"":'<div class="autocomplete-group"><strong>'+(t=r)+"</strong></div>")),void 0===s.post_id){var g=l,p="";"product_cat"===s.taxonomy?(g+=" dgwt-wcas-suggestion-cat",p+='<span class="dgwt-wcas-st--tax">'+dgwt_wcas.t.category+"</span>"):"product_tag"===s.taxonomy?(g+=" dgwt-wcas-suggestion-tag",p+='<span class="dgwt-wcas-st--tax">'+dgwt_wcas.t.tag+"</span>"):g+=" dgwt-wcas-suggestion-nores",h+='<div class="'+g+'" data-index="'+e+'">',h+='<span class="dgwt-wcas-st">'+p+i(s.value,a)+"</span>",h+="</div>"}else void 0!==s.parents&&(c=s.parents),!0===n.showImage&&void 0!==s.thumb_html&&(u=!0),d+=void 0!==s.post_id?'data-post-id="'+s.post_id+'" ':"",d+=void 0!==s.taxonomy?'data-taxonomy="'+s.taxonomy+'" ':"",d+=void 0!==s.term_id?'data-term-id="'+s.term_id+'" ':"",h+='<div class="'+l+' dgwt-wcas-suggestion-product" data-index="'+e+'" '+d+">",u&&(h+='<span class="dgwt-wcas-si">'+s.thumb_html+"</span>"),h+=u?'<div class="dgwt-wcas-content-wrapp">':"",h+='<span class="dgwt-wcas-st">',h+="<span>"+i(s.value,a)+c+"</span>",!0===n.showSKU&&void 0!==s.sku&&s.sku.length>0&&(h+='<span class="dgwt-wcas-sku">(SKU: '+i(s.sku,a)+")</span>"),h+="</span>",!0===n.showPrice&&void 0!==s.price&&(h+='<span class="dgwt-wcas-sp">'+s.price+"</span>"),!0===n.showDescription&&void 0!==s.desc&&s.desc&&(h+='<span class="dgwt-wcas-sd">'+i(s.desc,a)+"</span>"),!0===n.showFeaturedBadge&&!0===s.on_sale&&(h+='<span class="dgwt-wcas-badge dgwt-wcas-badge-os">'+n.saleBadgeText+"</span>"),!0===n.showFeaturedBadge&&!0===s.featured&&(h+='<span class="dgwt-wcas-badge dgwt-wcas-badge-f">'+n.featuredBadgeText+"</span>"),h+=u?"</div>":"",h+="</div>"}),this.adjustContainerWidth(),u.detach(),c.html(h),e.isFunction(g)&&g.call(s.element,c,s.suggestions),s.fixPositionCapture(),c.show(),c.parent().addClass("dgwt-wcas-open"),!0===n.positionFixed&&e(s.suggestionsContainer).addClass("dgwt-wcas-suggestions-fixed"),!0===n.showDetailsPanel&&(d.show(),s.fixHeight()),n.autoSelectFirst&&(s.selectedIndex=0,c.scrollTop(0),c.children("."+l).first().addClass(r)),s.visible=!0,s.findBestHint())}else this.options.showNoSuggestionNotice?this.noSuggestions():this.hide()},noSuggestions:function(){var t=e(this.suggestionsContainer),s=e(this.noSuggestionsContainer);s.detach(),t.empty(),t.append(s),this.fixPositionCapture(),t.show(),this.visible=!0},adjustContainerWidth:function(){var t,s=this,n=s.options,o=e("body"),i=e("."+n.searchFormClass+'[data-wcas-context="'+s.getContext()+'"]'),a=e(s.suggestionsContainer),l=e(s.detailsContainer),r=s.getFormOffset(),c=getComputedStyle(i[0]).width;if(c=Math.round(parseFloat(c.replace("px",""))),"auto"===n.width&&(t=s.el.outerWidth(),a.css("width",t+"px")),!0===n.showDetailsPanel){if(i.width()>=550)return o.addClass("dgwt-wcas-full-width"),c%2==0?(a.css("width",Math.round(c/2)),l.css("width",Math.round(c/2))):(a.css("width",Math.floor(c/2)),l.css("width",Math.ceil(c/2))),o.removeClass("dgwt-wcas-details-left"),o.removeClass("dgwt-wcas-details-right"),void(!0===n.is_rtl?l.css("left","0"):a.css("left",c/2+r.left+"px"));o.addClass("dgwt-wcas-details-right")}},findBestHint:function(){var t=this.el.val().toLowerCase(),s=null;t&&(e.each(this.suggestions,function(e,n){var o=0===n.value.toLowerCase().indexOf(t);return o&&(s=n),!o}),this.signalHint(s))},signalHint:function(t){var s="",n=this;t&&(s=n.currentValue+t.value.substr(n.currentValue.length)),n.hintValue!==s&&(n.hintValue=s,n.hint=t,(this.options.onHint||e.noop)(s))},preloader:function(t,s,n,o){var i,a,l="dgwt-wcas-preloader-wrapp",r=null==n?l:l+" "+n;"form"===s?a=this.getFormWrapper().find(".dgwt-wcas-preloader"):"details"===s&&(a=e(this.detailsContainer)),1==dgwt_wcas.show_preloader&&0!=a.length&&(!0===o?"hide"!==t?"show"===t&&(i='<div class="'+r+'"><div class="dgwt-wcas-default-preloader"></div></div>',a.html(i)):e(l).remove():"hide"===t?a.removeClass(n):a.addClass(n))},verifySuggestionsFormat:function(t){return t.length&&"string"==typeof t[0]?e.map(t,function(e){return{value:e,data:null}}):t},validateOrientation:function(t,s){return t=e.trim(t||"").toLowerCase(),-1===e.inArray(t,["auto","bottom","top"])&&(t=s),t},processResponse:function(e,t,s){var n=this,o=n.options;e.suggestions=n.verifySuggestionsFormat(e.suggestions),o.noCache||(n.cachedResponse[s]=e,o.preventBadQueries&&!e.suggestions.length&&n.badQueries.push(t)),t===n.getQuery(n.currentValue)&&(n.suggestions=e.suggestions,n.suggest())},activate:function(t){var s,n=this,o=n.classes.selected,i=e(n.suggestionsContainer),a=i.find("."+n.classes.suggestion);return i.find("."+o).removeClass(o),n.selectedIndex=t,-1!==n.selectedIndex&&a.length>n.selectedIndex?(s=a.get(n.selectedIndex),e(s).addClass(o),s):null},selectHint:function(){var t=e.inArray(this.hint,this.suggestions);this.select(t)},select:function(e){this.hide(),this.onSelect(e),this.disableKillerFn()},moveUp:function(){var t=this;if(-1!==t.selectedIndex)return 0===t.selectedIndex?(e(t.suggestionsContainer).children().first().removeClass(t.classes.selected),t.selectedIndex=-1,t.el.val(t.currentValue),void t.findBestHint()):void t.adjustScroll(t.selectedIndex-1)},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(t){var s=this,n=s.activate(t);if(n&&!s.canShowDetailsBox()){var o,i,a,l=e(n).outerHeight();o=n.offsetTop,a=(i=e(s.suggestionsContainer).scrollTop())+s.options.maxHeight-l,o<i?e(s.suggestionsContainer).scrollTop(o):o>a&&e(s.suggestionsContainer).scrollTop(o-s.options.maxHeight+l),s.options.preserveInput||s.el.val(s.getValue(s.suggestions[t].value)),s.signalHint(null)}},onSelect:function(t){var s=this,n=s.options.onSelect,o=s.suggestions[t];s.currentValue=s.getValue(o.value),s.currentValue===s.el.val()||s.options.preserveInput||s.el.val(s.currentValue),-1!=o.id&&(window.location.href=o.url),s.signalHint(null),s.suggestions=[],s.selection=o,e.isFunction(n)&&n.call(s.element,o)},onMouseOver:function(t){var s=this,n=s.options.onMouseOver,o=s.suggestions[t];s.selectedIndex!==t&&s.getDetails(o),e.isFunction(n)&&n.call(s.element,o)},onMouseLeave:function(t){var s=this.options.onMouseLeave,n=this.suggestions[t];e.isFunction(s)&&s.call(this.element,n)},getValue:function(e){var t,s,n=this.options.delimiter;return n?1===(s=(t=this.currentValue).split(n)).length?e:t.substr(0,t.length-s[s.length-1].length)+e:e},dispose:function(){this.el.off(".autocomplete").removeData("autocomplete"),this.disableKillerFn(),e(window).off("resize.autocomplete",this.fixPositionCapture),e(this.suggestionsContainer).remove()}},e.fn.dgwtWcasAutocomplete=function(t,s){var n="autocomplete";return arguments.length?this.each(function(){var o=e(this),i=o.data(n);"string"==typeof t?i&&"function"==typeof i[t]&&i[t](s):(i&&i.dispose&&i.dispose(),i=new r(this,t),o.data(n,i))}):this.first().data(n)},e(window).on("load",function(){e(".dgwt-wcas-search-submit").length>0&&e(".dgwt-wcas-search-submit").each(function(){var t=e(this).closest(".dgwt-wcas-search-wrapp").find(".dgwt-wcas-preloader");1==dgwt_wcas.is_rtl?t.css("left",6+e(this).outerWidth()+"px"):t.css("right",e(this).outerWidth()+"px")})}),e(document).ready(function(){var t,s,n=1==dgwt_wcas.show_details_box;(jQuery(window).width()<992||"ontouchend"in document)&&(n=!1),e(".dgwt-wcas-search-input").dgwtWcasAutocomplete({minChars:dgwt_wcas.min_chars,width:dgwt_wcas.sug_width,autoSelectFirst:!1,triggerSelectOnValidInput:!1,serviceUrl:dgwt_wcas.ajax_search_endpoint,paramName:"s",showDetailsPanel:n,showImage:1==dgwt_wcas.show_images,showPrice:1==dgwt_wcas.show_price,showDescription:1==dgwt_wcas.show_desc,showSKU:1==dgwt_wcas.show_sku,showSaleBadge:1==dgwt_wcas.show_sale_badge,showFeaturedBadge:1==dgwt_wcas.show_featured_badge,saleBadgeText:dgwt_wcas.t.sale_badge,featuredBadgeText:dgwt_wcas.t.featured_badge,is_rtl:1==dgwt_wcas.is_rtl,maxHeight:(t=300,s=.8*e(window).height(),t>s&&(t=s),t)})})});